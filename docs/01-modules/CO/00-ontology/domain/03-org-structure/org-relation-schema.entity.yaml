$schema: "https://xtalent.io/schemas/entity/v3"
$id: "xtalent:core:org-structure:org-relation-schema"

entity: OrgRelationSchema
classification: ENTITY
module: CO
submodule: org-structure
version: "1.0"

definition: |
  Schema definition for custom organizational relationship trees (e.g., financial hierarchy,
  risk chain, reporting structure).

description: |
  Defines custom organizational relationship schemas beyond the standard hierarchy.
  Each schema represents a different view or dimension of organizational structure
  (e.g., financial reporting, risk management, project teams).

purpose: "Dynamic organizational relationship schema definition"

# ----------------------------------------------------------------------------
# ATTRIBUTES
# ----------------------------------------------------------------------------
attributes:
  id:
    type: uuid
    required: true
    primary_key: true
    
  code:
    type: string
    required: true
    unique: true
    max_length: 50
    description: "Schema code"
    examples:
      - "FIN_HIER"      # Financial hierarchy
      - "RISK_CHAIN"    # Risk management chain
      - "PROJECT_ORG"   # Project organization
    
  name:
    type: string
    required: true
    max_length: 150
    description: "Schema name"
    
  root_scope:
    type: string
    required: true
    max_length: 20
    description: "Root scope: LE (Legal Entity) or BU (Business Unit)"
    enum:
      - LE
      - BU
    
  metadata:
    type: jsonb
    required: false
    description: "Additional rules (max_depth, validation rules, etc.)"
    
  is_active:
    type: boolean
    required: true
    default: true
    description: "Active status"

# ----------------------------------------------------------------------------
# VALIDATION RULES
# ----------------------------------------------------------------------------
validation_rules:
  - rule: "unique_code"
    expression: "UNIQUE(code)"
    message: "Schema code must be unique"
    severity: ERROR

references:
  database_design: "../../../03-design/1.core.v4.dbml#org_relation.schema"

metadata:
  created_at: "2025-12-25"
  dbml_source: "org_relation.schema (lines 499-506)"
