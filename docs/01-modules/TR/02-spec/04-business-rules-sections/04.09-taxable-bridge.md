# 9. Taxable Bridge Rules

**Total Rules**: 18  
**Priority**: HIGH: 12 rules, MEDIUM: 6 rules

---

## Category: Taxable Benefit Identification

### BR-TR-BRIDGE-001: Taxable vs Non-Taxable Classification

**Priority**: HIGH

**Description**:
Classify benefits and compensation components as taxable or non-taxable.

**Conditions**:
```
WHEN component created or benefit enrolled
THEN classify tax treatment
```

**Rules**:
1. Tax treatment types: FULLY_TAXABLE, PARTIALLY_EXEMPT, FULLY_EXEMPT
2. Fully taxable: Base salary, bonuses, equity vesting, commissions
3. Partially exempt: Allowances with thresholds (e.g., lunch 730K VND/month)
4. Fully exempt: Employer SI contributions, reimbursements
5. Classification per country tax rules

**Exceptions**:
- None

**Error Messages**:
- `ERR_BRIDGE_001`: "Invalid tax treatment classification: {type}."

**Related Requirements**: FR-TR-BRIDGE-001

**Related Entities**: CompensationComponent, BenefitPlan, TaxRule

---

### BR-TR-BRIDGE-002: Imputed Income Calculation

**Priority**: HIGH

**Description**:
Calculate imputed income for taxable benefits.

**Conditions**:
```
IF benefit has taxable value
THEN calculate imputed income
```

**Rules**:
1. Imputed income: Value of benefit provided to employee
2. Examples: Life insurance > $50K, personal use of company car, gym membership
3. Calculation: Fair market value - employee contribution
4. Add to taxable income for tax withholding
5. Report on W-2 (Box 12 or Box 14)

**Exceptions**:
- De minimis benefits: Value < $100, infrequent (not taxable)

**Error Messages**:
- `ERR_BRIDGE_002`: "Imputed income calculation failed: {reason}."

**Related Requirements**: FR-TR-BRIDGE-002

**Related Entities**: TaxableItem, BenefitEnrollment

---

### BR-TR-BRIDGE-003: Fringe Benefit Valuation

**Priority**: HIGH

**Description**:
Value fringe benefits for tax purposes.

**Conditions**:
```
WHEN valuing fringe benefit
THEN use IRS valuation method
```

**Rules**:
1. Valuation methods: Fair market value, Lease value, Cents-per-mile
2. Company car: Annual lease value or cents-per-mile method
3. Personal use percentage: Track business vs personal use
4. Housing: Fair rental value
5. Follow IRS Publication 15-B (US) or country-specific rules

**Exceptions**:
- None

**Error Messages**:
- `ERR_BRIDGE_003`: "Fringe benefit valuation failed: {reason}."

**Related Requirements**: FR-TR-BRIDGE-003

**Related Entities**: FringeBenefit, TaxableItem

---

### BR-TR-BRIDGE-004: Personal Use of Company Assets

**Priority**: MEDIUM

**Description**:
Calculate taxable value of personal use of company assets.

**Conditions**:
```
IF employee uses company asset for personal purposes
THEN calculate taxable value
```

**Rules**:
1. Assets: Company car, phone, laptop, club membership
2. Track usage: Business % vs Personal %
3. Taxable value = Total value × Personal %
4. Monthly or annual calculation
5. Employee can reimburse to avoid taxation

**Exceptions**:
- De minimis use: Minimal personal use not taxable

**Error Messages**:
- None

**Related Requirements**: FR-TR-BRIDGE-004

**Related Entities**: CompanyAsset, TaxableItem

---

### BR-TR-BRIDGE-005: Relocation Expense Taxability

**Priority**: MEDIUM

**Description**:
Determine taxability of relocation expenses.

**Conditions**:
```
WHEN relocation expense paid
THEN determine tax treatment
```

**Rules**:
1. US (post-2017): All relocation expenses taxable
2. Qualified moving expenses: No longer exempt (US)
3. Gross-up option: Employer covers tax on relocation
4. Report on W-2
5. Country-specific rules apply

**Exceptions**:
- Some countries still allow exemptions for qualified moves

**Error Messages**:
- None

**Related Requirements**: FR-TR-BRIDGE-005

**Related Entities**: RelocationExpense, TaxableItem

---

### BR-TR-BRIDGE-006: Education Assistance Taxability

**Priority**: MEDIUM

**Description**:
Determine taxability of education assistance.

**Conditions**:
```
IF education assistance provided
THEN determine tax treatment
```

**Rules**:
1. US: Up to $5,250/year tax-free (Section 127)
2. Excess over $5,250: Taxable
3. Must be qualified education expenses
4. Job-related education: May be tax-free
5. Report excess on W-2

**Exceptions**:
- None

**Error Messages**:
- None

**Related Requirements**: FR-TR-BRIDGE-006

**Related Entities**: EducationAssistance, TaxableItem

---

## Category: Tax Bridge Processing

### BR-TR-BRIDGE-007: Taxable Item Creation

**Priority**: HIGH

**Description**:
Create taxable items for tax withholding.

**Conditions**:
```
WHEN taxable event occurs
THEN create taxable item
```

**Rules**:
1. Taxable events: Equity vesting, bonus payment, benefit premium, perk redemption
2. Taxable item includes: Employee, Amount, Source, Tax year, Item type
3. Item types: SUPPLEMENTAL_INCOME, IMPUTED_INCOME, FRINGE_BENEFIT
4. Status: PENDING → SENT_TO_PAYROLL → PROCESSED
5. Audit trail maintained

**Exceptions**:
- None

**Error Messages**:
- `ERR_BRIDGE_007`: "Taxable item creation failed: {reason}."

**Related Requirements**: FR-TR-BRIDGE-007

**Related Entities**: TaxableItem

---

### BR-TR-BRIDGE-008: Tax Gross-Up Calculation

**Priority**: HIGH

**Description**:
Calculate tax gross-up for employer-paid taxes.

**Conditions**:
```
IF employer pays employee's tax
THEN calculate gross-up amount
```

**Rules**:
1. Gross-up formula: Grossed_up_amount = Net_amount / (1 - Tax_rate)
2. Example: $10K bonus, 30% tax → $14,286 gross-up
3. Iterative calculation for progressive rates
4. Employer pays: Bonus + Tax on bonus
5. Report full amount on W-2

**Exceptions**:
- None

**Error Messages**:
- `ERR_BRIDGE_008`: "Tax gross-up calculation failed: {reason}."

**Related Requirements**: FR-TR-BRIDGE-008

**Related Entities**: TaxGrossUp, TaxableItem

---

### BR-TR-BRIDGE-009: Payroll Integration

**Priority**: HIGH

**Description**:
Send taxable items to payroll for withholding.

**Conditions**:
```
WHEN taxable item created
THEN send to payroll
```

**Rules**:
1. Batch taxable items by pay period
2. Send to payroll module before payroll run
3. Payroll adds to employee's taxable income
4. Payroll calculates and withholds tax
5. Results returned to TR module

**Exceptions**:
- None

**Error Messages**:
- `ERR_BRIDGE_009`: "Payroll integration failed: {reason}."

**Related Requirements**: FR-TR-BRIDGE-009

**Related Entities**: TaxableItem, PayrollRun

---

### BR-TR-BRIDGE-010: W-2 Box Mapping

**Priority**: HIGH

**Description**:
Map taxable items to W-2 boxes.

**Conditions**:
```
WHEN generating W-2
THEN map taxable items to boxes
```

**Rules**:
1. Box 1: Wages, tips, other compensation (all taxable income)
2. Box 12: Deferred compensation codes (D=401k, DD=Health insurance)
3. Box 14: Other information (RSU vesting, imputed income)
4. Mapping per IRS guidelines
5. Country-specific form mapping

**Exceptions**:
- None

**Error Messages**:
- `ERR_BRIDGE_010`: "W-2 box mapping failed: {reason}."

**Related Requirements**: FR-TR-BRIDGE-010

**Related Entities**: TaxableItem, W2Form

---

### BR-TR-BRIDGE-011: Monthly/Quarterly Processing

**Priority**: MEDIUM

**Description**:
Process taxable items on monthly or quarterly basis.

**Conditions**:
```
WHEN period ends
THEN process taxable items
```

**Rules**:
1. Aggregate taxable items for period
2. Send to payroll for withholding
3. Track processing status
4. Reconcile with payroll results
5. Generate period reports

**Exceptions**:
- None

**Error Messages**:
- None

**Related Requirements**: FR-TR-BRIDGE-011

**Related Entities**: TaxableItem, ProcessingPeriod

---

### BR-TR-BRIDGE-012: Year-End Reconciliation

**Priority**: HIGH

**Description**:
Reconcile taxable items at year-end.

**Conditions**:
```
WHEN tax year ends
THEN reconcile taxable items
```

**Rules**:
1. Sum all taxable items for year
2. Compare to W-2 amounts
3. Identify discrepancies
4. Correct errors
5. Generate reconciliation report

**Exceptions**:
- None

**Error Messages**:
- `WARN_BRIDGE_012`: "Year-end reconciliation variance: {amount}."

**Related Requirements**: FR-TR-BRIDGE-012

**Related Entities**: TaxableItem, W2Form, ReconciliationReport

---

## Category: Compliance & Reporting

### BR-TR-BRIDGE-013: IRS Publication 15-B Compliance

**Priority**: HIGH

**Description**:
Ensure compliance with IRS Publication 15-B (Employer's Tax Guide to Fringe Benefits).

**Conditions**:
```
WHEN valuing fringe benefits
THEN follow IRS Pub 15-B
```

**Rules**:
1. Use IRS-approved valuation methods
2. Follow exclusion rules for qualified benefits
3. Apply de minimis benefit rules
4. Document valuation methodology
5. Update for annual IRS changes

**Exceptions**:
- None

**Error Messages**:
- None

**Related Requirements**: FR-TR-BRIDGE-013

**Related Entities**: FringeBenefit, TaxRule

---

### BR-TR-BRIDGE-014: Taxable Item Audit Trail

**Priority**: HIGH

**Description**:
Maintain complete audit trail for taxable items.

**Conditions**:
```
WHEN taxable item activity occurs
THEN log to audit trail
```

**Rules**:
1. Log events: Creation, Modification, Sent to payroll, Processed
2. Audit record: User, Timestamp, Action, Before/After values
3. Immutable logs
4. Retention: 7 years
5. Searchable and reportable

**Exceptions**:
- None

**Error Messages**:
- `ERR_BRIDGE_014`: "Audit log write failed: {reason}."

**Related Requirements**: FR-TR-BRIDGE-014

**Related Entities**: AuditLog, TaxableItem

---

### BR-TR-BRIDGE-015: Employee Communication

**Priority**: MEDIUM

**Description**:
Communicate taxable events to employees.

**Conditions**:
```
WHEN taxable item created
THEN notify employee
```

**Rules**:
1. Notify employee of taxable event
2. Explain tax impact
3. Provide estimated tax amount
4. Include in pay stub
5. Annual summary in total rewards statement

**Exceptions**:
- None

**Error Messages**:
- None

**Related Requirements**: FR-TR-BRIDGE-015

**Related Entities**: Notification, TaxableItem

---

### BR-TR-BRIDGE-016: Correction Procedures

**Priority**: MEDIUM

**Description**:
Process corrections to taxable items.

**Conditions**:
```
IF error found in taxable item
THEN correct and reprocess
```

**Rules**:
1. Identify error source
2. Create corrected taxable item
3. Mark original as corrected
4. Reprocess through payroll
5. File corrected W-2 if needed (W-2c)

**Exceptions**:
- None

**Error Messages**:
- None

**Related Requirements**: FR-TR-BRIDGE-016

**Related Entities**: TaxableItem, TaxFormCorrection

---

### BR-TR-BRIDGE-017: Multi-Country Tax Handling

**Priority**: HIGH

**Description**:
Handle taxable items for multiple countries.

**Conditions**:
```
FOR each country
  apply country-specific tax rules
```

**Rules**:
1. Country-specific taxability rules
2. Vietnam: Add to monthly income, progressive tax
3. US: Supplemental income, flat 22% federal
4. Singapore: Taxed as ordinary income
5. Country-specific reporting requirements

**Exceptions**:
- None

**Error Messages**:
- `ERR_BRIDGE_017`: "Multi-country tax handling failed for {country}: {reason}."

**Related Requirements**: FR-TR-BRIDGE-017

**Related Entities**: TaxableItem, Country, TaxRule

---

### BR-TR-BRIDGE-018: Tax Treaty Considerations

**Priority**: MEDIUM

**Description**:
Apply tax treaty rules for international employees.

**Conditions**:
```
IF employee covered by tax treaty
THEN apply treaty provisions
```

**Rules**:
1. Identify applicable tax treaties
2. Apply treaty exemptions or reduced rates
3. Require treaty claim forms
4. Document treaty application
5. Report on tax forms

**Exceptions**:
- None

**Error Messages**:
- None

**Related Requirements**: FR-TR-BRIDGE-018

**Related Entities**: TaxTreaty, TaxableItem

---

## Summary: Taxable Bridge Rules

**Total Rules**: 18  
**Priority Breakdown**:
- HIGH: 12 rules (67%)
- MEDIUM: 6 rules (33%)

**Categories**:
1. Taxable Benefit Identification (6 rules)
2. Tax Bridge Processing (6 rules)
3. Compliance & Reporting (6 rules)

**Key Highlights**:
- Taxable vs non-taxable classification
- Imputed income calculation (life insurance, company car, etc.)
- Fringe benefit valuation (IRS Pub 15-B)
- Tax gross-up calculation
- Payroll integration for tax withholding
- W-2 box mapping
- Multi-country tax handling
- Tax treaty considerations

---

**Status**: ✅ Taxable Bridge Rules Complete (18/18)
